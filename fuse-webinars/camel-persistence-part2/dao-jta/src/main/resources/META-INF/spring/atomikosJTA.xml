<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2011 FuseSource
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:osgi="http://www.springframework.org/schema/osgi"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/osgi
           http://www.springframework.org/schema/osgi/spring-osgi.xsd
           http://www.springframework.org/schema/context
	       http://www.springframework.org/schema/context/spring-context.xsd">

    <!-- Optional: add a log administrator
    <bean id="localLogAdministrator"
     class="com.atomikos.icatch.admin.imp.LocalLogAdministrator"/>
     -->

<!--    <bean id="userTransactionService"
      class="com.atomikos.icatch.config.UserTransactionServiceImp"
      init-method="init" destroy-method="shutdownForce">
        <constructor-arg>
            &lt;!&ndash; IMPORTANT: specify all Atomikos properties here &ndash;&gt;
            <props>
                <prop key="com.atomikos.icatch.service">
                  com.atomikos.icatch.standalone.UserTransactionServiceFactory
                </prop>
            </props>
        </constructor-arg>
        &lt;!&ndash;
        <property name="initialLogAdministrators">
            <list>
                <ref bean="localLogAdministrator"/>
            </list>
        </property>
        &ndash;&gt;
    </bean>

    &lt;!&ndash;
         Construct Atomikos UserTransactionManager,
         needed to configure Spring
    &ndash;&gt;
    <bean id="AtomikosTransactionManager"
          class="com.atomikos.icatch.jta.UserTransactionManager"
          init-method="init" destroy-method="close"
          depends-on="userTransactionService">

       &lt;!&ndash; IMPORTANT: disable startup because the userTransactionService above does this &ndash;&gt;
       <property name="startupTransactionService" value="false"/>

       &lt;!&ndash;
             when close is called,
             should we force transactions to terminate or not?
       &ndash;&gt;
       <property name="forceShutdown" value="false" />
    </bean>

    &lt;!&ndash;
         Also use Atomikos UserTransactionImp,
         needed to configure Spring
    &ndash;&gt;
    <bean id="AtomikosUserTransaction"
          class="com.atomikos.icatch.jta.UserTransactionImp"
          depends-on="userTransactionService">
       <property name="transactionTimeout" value="300" />
    </bean>

    &lt;!&ndash;
       Configure the Spring framework to use JTA transactions from Atomikos
    &ndash;&gt;
    <bean id="JtaTransactionManager"
          class="org.springframework.transaction.jta.JtaTransactionManager"
          depends-on="userTransactionService">
       <property name="transactionManager" ref="AtomikosTransactionManager" />
       <property name="userTransaction" ref="AtomikosUserTransaction" />
    </bean>

    <bean id="reportdb"
          class="com.atomikos.jdbc.nonxa.AtomikosNonXADataSourceBean">
        <property name="uniqueResourceName" value="hsqldb"/>
        <property name="driverClassName" value="org.hsqldb.jdbcDriver"/>
        <property name="url" value="jdbc:hsqldb:hsql://localhost/reportdb"/>
        <property name="user" value="sa"/>
        <property name="password" value=""/>
        <property name="poolSize" value="3"/>
    </bean>-->
</beans>